---
import BaseLayout from "~/layouts/BaseLayout.astro";
import ArticleCard from "~/components/ArticleCard.astro";
import { getCollection } from 'astro:content';

// Get all news (filter by English language)
const allBerita = await getCollection('berita', ({ data }) => !data.draft && data.lang === 'en');
const berita = allBerita.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<BaseLayout title="CAAIP â€” News" description="Latest news and updates from CAAIP" lang="en">
  <section class="section container-px mx-auto">
    <h1 class="text-3xl font-bold text-caaip-blue mb-8">Latest News</h1>
    
    {berita.length > 0 ? (
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {berita.map((item) => (
          <ArticleCard
            title={item.data.title}
            href={`/en/berita/${item.slug}`}
            date={item.data.date.toISOString()}
            excerpt={item.data.excerpt}
            cover={item.data.cover}
            author={item.data.author}
          />
        ))}
      </div>
    ) : (
      <div class="text-center py-16">
        <p class="text-slate-600 text-lg">No news available yet.</p>
        <p class="text-slate-500 text-sm mt-2">Please check back later for updates.</p>
      </div>
    )}
  </section>
</BaseLayout>
