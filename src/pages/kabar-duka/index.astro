---
import BaseLayout from "~/layouts/BaseLayout.astro";
import { getCollection } from 'astro:content';

const items = (await getCollection('kabarDuka', ({ data }) => !data.draft))
  .sort((a, b) => Number(b.data.date) - Number(a.data.date));
---
<BaseLayout title="Kabar Duka â€” CAAIP" description="Pengumuman resmi duka cita">
  <section class="section container-px mx-auto">
    <h1 class="text-2xl font-bold text-caaip-blue">Kabar Duka</h1>
    <p class="mt-2 text-slate-600">Pengumuman resmi duka cita dari sivitas CAAIP.</p>

    {items.length === 0 ? (
      <p class="mt-6 text-slate-600">Tidak ada pengumuman saat ini.</p>
    ) : (
      <ul class="mt-6 space-y-4">
        {items.map((i) => (
          <li class="border rounded-lg p-4">
            <p class="text-sm text-slate-500">{new Date(i.data.date).toLocaleDateString('id-ID')}</p>
            <p class="font-semibold text-slate-800">{i.data.name}</p>
            {i.data.message && <p class="text-slate-700 mt-1">{i.data.message}</p>}
          </li>
        ))}
      </ul>
    )}
  </section>
</BaseLayout>
